{{- if and (.Values.clickhouse.persistentVolume.enable) (eq (.Values.clickhouse.persistentVolume.provisioner) "NFS") }}
apiVersion: v1
kind: PersistentVolume
metadata:
  name: clickhouse-pv
spec:
  storageClassName: clickhouse-storage
  capacity:
    storage: {{ .Values.clickhouse.storageSize }}
  accessModes:
    - ReadWriteOnce
  volumeMode: Filesystem
  nfs:
    path: {{ .Values.clickhouse.persistentVolume.nfsPath }}
    server: {{ .Values.clickhouse.persistentVolume.nfsHost }}
{{- end }}
